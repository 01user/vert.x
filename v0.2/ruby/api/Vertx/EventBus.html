<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>
  Class: Vertx::EventBus
  
    &mdash; vert.x Ruby API
  
</title>

  <link rel="stylesheet" href="../css/style.css" type="text/css" media="screen" charset="utf-8" />

  <link rel="stylesheet" href="../css/common.css" type="text/css" media="screen" charset="utf-8" />

<script type="text/javascript" charset="utf-8">
  relpath = '..';
  if (relpath != '') relpath += '/';
</script>

  <script type="text/javascript" charset="utf-8" src="../js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="../js/app.js"></script>


  </head>
  <body>
    <script type="text/javascript" charset="utf-8">
      if (window.top.frames.main) document.body.className = 'frames';
    </script>
    
    <div id="header">
      <div id="menu">
  
    <a href="../_index.html">Index (E)</a> &raquo; 
    <span class='title'><span class='object_link'><a href="../Vertx.html" title="Vertx (module)">Vertx</a></span></span>
     &raquo; 
    <span class="title">EventBus</span>
  
  
  <div class="noframes"><span class="title">(</span><a href="." target="_top">no frames</a><span class="title">)</span></div>
</div>

      <div id="search">
  
    <a id="class_list_link" href="#">Class List</a>
  
    <a id="method_list_link" href="#">Method List</a>
  
    <a id="file_list_link" href="#">File List</a>
  
</div>
      <div class="clear"></div>
    </div>
    
    <iframe id="search_frame"></iframe>
    
    <div id="content"><h1>Class: Vertx::EventBus
  
  
  
</h1>

<dl class="box">
  
    <dt class="r1">Inherits:</dt>
    <dd class="r1">
      <span class="inheritName">Object</span>
      
        <ul class="fullTree">
          <li>Object</li>
          
            <li class="next">Vertx::EventBus</li>
          
        </ul>
        <a href="#" class="inheritanceTree">show all</a>
      
      </dd>
    
  
  
    
  
    
  
  
  
    <dt class="r2 last">Defined in:</dt>
    <dd class="r2 last">src/main/ruby/core/event_bus.rb</dd>
  
</dl>
<div class="clear"></div>

<h2>Overview</h2><div class="docstring">
  <div class="discussion">
    <p>
This class represents a distributed lightweight event bus which can
encompass multiple vert.x instances. It is very useful for otherwise
isolated vert.x application instances to communicate with each other.
</p>
<p>
Messages sent over the event bus are represented by instances of the
<span class='object_link'><a href="Message.html" title="Vertx::Message (class)">Message</a></span> class.
</p>
<p>
The event bus implements a distributed publish / subscribe network.
</p>
<p>
Messages are sent to an address which is simply an arbitrary String. There
can be multiple handlers can be registered against that address. Any
handlers with a matching name will receive the message irrespective of what
vert.x application instance and what vert.x instance they are located in.
</p>
<p>
All messages sent over the bus are transient. On event of failure of all or
part of the event bus messages may be lost. Applications should be coded to
cope with lost messages, e.g. by resending them, and making application
services idempotent.
</p>
<p>
The order of messages received by any specific handler from a specific
sender will match the order of messages sent from that sender.
</p>
<p>
When sending a message, a reply handler can be provided. If so, it will be
called when the reply from the receiver has been received.
</p>


  </div>
</div>
<div class="tags">
  <h3>Author:</h3>
<ul class="author">
  
    <li>
      
      
      
      
        
        <div class='inline'><p>
<a href="http://tfox.org" target="_parent" title="Tim Fox">Tim Fox</a>
</p>
</div>
      
    </li>
  
</ul>

</div>
  <h2>Constant Summary</h2>
  
    <dl class="constants">
      
        <dt id="handler_map-classvariable" class="">@@handler_map =
          
        </dt>
        <dd><pre class="code"><span class='java identifier id'>java</span><span class='dot token'>.</span><span class='util identifier id'>util</span><span class='dot token'>.</span><span class='concurrent identifier id'>concurrent</span><span class='dot token'>.</span><span class='ConcurrentHashMap constant id'>ConcurrentHashMap</span><span class='dot token'>.</span><span class='new identifier id'>new</span>
</pre></dd>
      
        <dt id="handler_seq-classvariable" class="">@@handler_seq =
          
        </dt>
        <dd><pre class="code"><span class='java identifier id'>java</span><span class='dot token'>.</span><span class='util identifier id'>util</span><span class='dot token'>.</span><span class='concurrent identifier id'>concurrent</span><span class='dot token'>.</span><span class='atomic identifier id'>atomic</span><span class='dot token'>.</span><span class='AtomicLong constant id'>AtomicLong</span><span class='dot token'>.</span><span class='new identifier id'>new</span><span class='lparen token'>(</span><span class='integer val'>0</span><span class='rparen token'>)</span>
</pre></dd>
      
    </dl>
  





  
    <h2>
      Class Method Summary
      <small>(<a href="#" class="summary_toggle">collapse</a>)</small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#register_handler-class_method" title="register_handler (class method)">+ (FixNum) <strong>register_handler</strong>(address, &amp;message_hndlr) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
Register a handler.
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#send-class_method" title="send (class method)">+ (Object) <strong>send</strong>(message, &amp;reply_handler) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
Send a message on the event bus It will be called when the reply from a
receiver is received.
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#unregister_handler-class_method" title="unregister_handler (class method)">+ (Object) <strong>unregister_handler</strong>(handler_id) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
Unregisters a handler.
</p>
</div></span>
  
</li>

      
    </ul>
  



  <div id="class_method_details" class="method_details_list">
    <h2>Class Method Details</h2>
    
    
      <div class="method_details first">
  <p class="signature first" id="register_handler-class_method">
  
    + (<tt>FixNum</tt>) <strong>register_handler</strong>(address, &amp;message_hndlr) 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
Register a handler. received by the handler. A single handler can be
registered against many addresses.
</p>


  </div>
</div>
<div class="tags">
  <h3>Parameters:</h3>
<ul class="param">
  
    <li>
      
        <span class='name'>address</span>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>
The address to register for. Any messages sent to that address will be
</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>message_hndlr</span>
      
      
        <span class='type'>(<tt>Block</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>
The handler
</p>
</div>
      
    </li>
  
</ul>
<h3>Returns:</h3>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>FixNum</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>
id of the handler which can be used in <span class='object_link'><a href="#unregister_handler-class_method" title="Vertx::EventBus.unregister_handler (method)">unregister_handler</a></span>
</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


62
63
64
65
66
67
68</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'src/main/ruby/core/event_bus.rb', line 62</span>

<span class='def def kw'>def</span> <span class='EventBus constant id'>EventBus</span><span class='dot token'>.</span><span class='register_handler identifier id'>register_handler</span><span class='lparen token'>(</span><span class='address identifier id'>address</span><span class='comma token'>,</span> <span class='bitand op'>&amp;</span><span class='message_hndlr identifier id'>message_hndlr</span><span class='rparen token'>)</span>
  <span class='internal identifier id'>internal</span> <span class='assign token'>=</span> <span class='InternalHandler constant id'>InternalHandler</span><span class='dot token'>.</span><span class='new identifier id'>new</span><span class='lparen token'>(</span><span class='address identifier id'>address</span><span class='comma token'>,</span> <span class='message_hndlr identifier id'>message_hndlr</span><span class='rparen token'>)</span>
  <span class='org identifier id'>org</span><span class='dot token'>.</span><span class='vertx identifier id'>vertx</span><span class='dot token'>.</span><span class='java identifier id'>java</span><span class='dot token'>.</span><span class='core identifier id'>core</span><span class='dot token'>.</span><span class='cluster identifier id'>cluster</span><span class='dot token'>.</span><span class='EventBus constant id'>EventBus</span><span class='dot token'>.</span><span class='instance identifier id'>instance</span><span class='dot token'>.</span><span class='registerHandler identifier id'>registerHandler</span><span class='lparen token'>(</span><span class='address identifier id'>address</span><span class='comma token'>,</span> <span class='internal identifier id'>internal</span><span class='rparen token'>)</span>
  <span class='id identifier id'>id</span> <span class='assign token'>=</span> <span class='@@handler_seq ivar id'>@@handler_seq</span><span class='dot token'>.</span><span class='incrementAndGet identifier id'>incrementAndGet</span>
  <span class='@@handler_map ivar id'>@@handler_map</span><span class='dot token'>.</span><span class='put identifier id'>put</span><span class='lparen token'>(</span><span class='id identifier id'>id</span><span class='comma token'>,</span> <span class='internal identifier id'>internal</span><span class='rparen token'>)</span>
  <span class='id identifier id'>id</span>
<span class='end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="send-class_method">
  
    + (<tt>Object</tt>) <strong>send</strong>(message, &amp;reply_handler) 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
Send a message on the event bus It will be called when the reply from a
receiver is received.
</p>


  </div>
</div>
<div class="tags">
  <h3>Parameters:</h3>
<ul class="param">
  
    <li>
      
        <span class='name'>message</span>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="Message.html" title="Vertx::Message (class)">Message</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>
The message to send
</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>reply_handler</span>
      
      
        <span class='type'>(<tt>Block</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>
replyHandler An optional reply handler.
</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


49
50
51
52
53
54
55</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'src/main/ruby/core/event_bus.rb', line 49</span>

<span class='def def kw'>def</span> <span class='EventBus constant id'>EventBus</span><span class='dot token'>.</span><span class='send identifier id'>send</span><span class='lparen token'>(</span><span class='message identifier id'>message</span><span class='comma token'>,</span> <span class='bitand op'>&amp;</span><span class='reply_handler identifier id'>reply_handler</span><span class='rparen token'>)</span>
  <span class='if if kw'>if</span> <span class='reply_handler identifier id'>reply_handler</span> <span class='neq op'>!=</span> <span class='nil nil kw'>nil</span>
    <span class='org identifier id'>org</span><span class='dot token'>.</span><span class='vertx identifier id'>vertx</span><span class='dot token'>.</span><span class='java identifier id'>java</span><span class='dot token'>.</span><span class='core identifier id'>core</span><span class='dot token'>.</span><span class='cluster identifier id'>cluster</span><span class='dot token'>.</span><span class='EventBus constant id'>EventBus</span><span class='dot token'>.</span><span class='instance identifier id'>instance</span><span class='dot token'>.</span><span class='send identifier id'>send</span><span class='lparen token'>(</span><span class='message identifier id'>message</span><span class='dot token'>.</span><span class='_to_java_message identifier id'>_to_java_message</span><span class='comma token'>,</span> <span class='reply_handler identifier id'>reply_handler</span><span class='rparen token'>)</span>
  <span class='else else kw'>else</span>
    <span class='org identifier id'>org</span><span class='dot token'>.</span><span class='vertx identifier id'>vertx</span><span class='dot token'>.</span><span class='java identifier id'>java</span><span class='dot token'>.</span><span class='core identifier id'>core</span><span class='dot token'>.</span><span class='cluster identifier id'>cluster</span><span class='dot token'>.</span><span class='EventBus constant id'>EventBus</span><span class='dot token'>.</span><span class='instance identifier id'>instance</span><span class='dot token'>.</span><span class='send identifier id'>send</span><span class='lparen token'>(</span><span class='message identifier id'>message</span><span class='dot token'>.</span><span class='_to_java_message identifier id'>_to_java_message</span><span class='rparen token'>)</span>
  <span class='end end kw'>end</span>
<span class='end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="unregister_handler-class_method">
  
    + (<tt>Object</tt>) <strong>unregister_handler</strong>(handler_id) 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
Unregisters a handler
</p>


  </div>
</div>
<div class="tags">
  <h3>Parameters:</h3>
<ul class="param">
  
    <li>
      
        <span class='name'>handler_id</span>
      
      
        <span class='type'>(<tt>FixNum</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>
The id of the handler to unregister. Returned from
<span class='object_link'><a href="#register_handler-class_method" title="Vertx::EventBus.register_handler (method)">register_handler</a></span>
</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


72
73
74
75
76</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'src/main/ruby/core/event_bus.rb', line 72</span>

<span class='def def kw'>def</span> <span class='EventBus constant id'>EventBus</span><span class='dot token'>.</span><span class='unregister_handler identifier id'>unregister_handler</span><span class='lparen token'>(</span><span class='handler_id identifier id'>handler_id</span><span class='rparen token'>)</span>
  <span class='handler identifier id'>handler</span> <span class='assign token'>=</span> <span class='@@handler_map ivar id'>@@handler_map</span><span class='dot token'>.</span><span class='remove identifier id'>remove</span><span class='lparen token'>(</span><span class='handler_id identifier id'>handler_id</span><span class='rparen token'>)</span>
  <span class='raise identifier id'>raise</span> <span class='dstring node'>&quot;Cannot find handler for id #{handler_id}&quot;</span> <span class='if if_mod kw'>if</span> <span class='notop op'>!</span><span class='handler identifier id'>handler</span>
  <span class='org identifier id'>org</span><span class='dot token'>.</span><span class='vertx identifier id'>vertx</span><span class='dot token'>.</span><span class='java identifier id'>java</span><span class='dot token'>.</span><span class='core identifier id'>core</span><span class='dot token'>.</span><span class='cluster identifier id'>cluster</span><span class='dot token'>.</span><span class='EventBus constant id'>EventBus</span><span class='dot token'>.</span><span class='instance identifier id'>instance</span><span class='dot token'>.</span><span class='unregisterHandler identifier id'>unregisterHandler</span><span class='lparen token'>(</span><span class='handler identifier id'>handler</span><span class='dot token'>.</span><span class='address identifier id'>address</span><span class='comma token'>,</span> <span class='handler identifier id'>handler</span><span class='rparen token'>)</span>
<span class='end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

</div>
    
    <div id="footer">
  Generated on Thu Dec 15 18:49:02 2011 by 
  <a href="http://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.7.2 (ruby-1.8.7).
</div>

  </body>
</html>